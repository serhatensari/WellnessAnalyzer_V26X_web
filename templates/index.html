<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>WellnessAnalyzer UltraPremium v26</title>
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>

<div class="layout">
  <!-- Sol MenÃ¼ -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo-circle">WA</div>
      <div class="brand-text">
        <span class="brand-name" id="uiBrandName">WELLNESSANALYZER</span>
        <span class="brand-version" id="uiBrandVersion">UltraPremium v26 Pro</span>
      </div>
    </div>

    <nav class="nav nav-vertical">
      <a href="#" class="nav-item active" data-target="tab-pdf" id="menuPdf">PDF ile Analiz</a>
      <a href="#" class="nav-item" data-target="tab-complaint" id="menuComplaint">ÅikÃ¢yet ile Analiz</a>
      <a href="#" class="nav-item" data-target="tab-compare" id="menuCompare">Ä°ki Testi KarÅŸÄ±laÅŸtÄ±r</a>
    </nav>

    <section class="card">
      <h3 id="uiCreditsTitle">Kredi KullanÄ±mÄ±</h3>
      <p id="uiCreditsSingle">
        âœ… Tek dil analiz: <strong>1 kredi</strong>
      </p>
      <p id="uiCreditsDouble">
        ğŸŒ Ã‡ift dil analiz: <strong>2 kredi</strong>
      </p>
      <p class="muted" id="uiCreditsNote">
        Ã‡ift dil seÃ§ildiÄŸinde tÃ¼m rapor iÃ§erikleri ve baÅŸlÄ±klar iki dilde (alt alta) hazÄ±rlanÄ±r.
      </p>
    </section>

    <section class="card">
      <h3 id="uiHistoryTitle">Son Raporlar (60 gÃ¼n)</h3>
      {% if history %}
        <ul class="history-list">
          {% for h in history %}
            <li>
              <a href="/report/{{ h.id }}">{{ h.title }}</a>
              <span class="history-meta">{{ h.created_at }} Â· {{ h.type }}</span>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="muted" id="uiNoHistory">HenÃ¼z kayÄ±tlÄ± rapor yok.</p>
      {% endif %}
    </section>
  </aside>

  <!-- SaÄŸ Ana Alan -->
  <main class="content">
    <!-- Ãœst bar: ArayÃ¼z dili seÃ§imi -->
    <div class="topbar">
      <div class="lang-switch">
        <label for="globalLang" id="uiGlobalLangLabel">ğŸŒ ArayÃ¼z Dili</label>
        <select id="globalLang" class="select">
          <option value="tr">TÃ¼rkÃ§e</option>
          <option value="en">English</option>
          <option value="de">Deutsch</option>
          <option value="es">EspaÃ±ol</option>
          <option value="pt">PortuguÃªs</option>
          <option value="fr">FranÃ§ais</option>
          <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
          <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
          <option value="fa">ÙØ§Ø±Ø³ÛŒ</option>
          <option value="mn">ĞœĞ¾Ğ½Ğ³Ğ¾Ğ»</option>
          <option value="id">Bahasa Indonesia</option>
          <option value="it">Italiano</option>
          <option value="az">AzÉ™rbaycan dili</option>
        </select>
      </div>
    </div>

    <!-- PDF ile Analiz Sekmesi -->
    <section class="card main-section" id="tab-pdf">
      <h1 id="uiPdfTitle">PDF ile Wellness Analizi</h1>
      <p class="subtitle" id="uiPdfSubtitle">
        Test PDF'ini yÃ¼kle. Sistem otomatik olarak <strong>Ultra DetaylÄ± Wellness Raporu</strong> Ã¼retir.
      </p>

      <form class="form" action="/analyze-pdf" method="post" enctype="multipart/form-data" onsubmit="showLoader()">
        <input type="hidden" name="detail" value="ultra">

        <div class="form-group">
          <label id="uiLblPdfFile">Test PDF DosyasÄ±</label>
          <input type="file" name="pdf_file" accept="application/pdf" required>
        </div>

        <div class="form-group">
          <label id="uiLblBrandPdf">Marka</label>
          <select name="brand" id="brandPdf">
            <option value="generic">Genel Wellness Analizi (MarkasÄ±z)</option>
            <option value="onemore">OneMore International</option>
            <option value="xaura">Xaura Global</option>
            <option value="atomy">Atomy</option>
            <option value="doctorem">Doctorem International</option>
            <option value="algo_tts">Algophyco TTS</option>
            <option value="herbalife">Herbalife</option>
            <option value="welltures">Welltures Global</option>
            <option value="now">Now International</option>
            <option value="forever">Forever Living</option>
            <option value="siberian">Siberian Wellness</option>
            <option value="amare">Amare Global</option>
            <option value="onyedi">Onyedi Wellness</option>
            <option value="oxo">Oxo Global</option>
            <option value="som">Som International</option>
            <option value="indeva">Ä°ndeva Global</option>
            <option value="pati">PatiPro Wellness</option>
          </select>
        </div>

        <div class="form-group">
          <label id="uiLblPrimaryLang">Birinci Dil</label>
          <!-- Raporun DÄ°LÄ°: target_lang -->
          <select name="target_lang" id="targetLangPdf"></select>
        </div>

        <div class="form-group">
          <label id="uiLblSecondLang">Ä°kinci Dil (isteÄŸe baÄŸlÄ±)</label>
          <!-- Raporun 2. DÄ°LÄ°: second_lang -->
          <select name="second_lang" id="secondLangPdf">
            <!-- JS dolduracak -->
          </select>
        </div>

        <div class="form-group">
          <label id="uiLblBilingual">Ã‡ift Dil PDF (2 kredi)</label>
          <label>
            <input type="checkbox" name="bilingual" value="1">
            <span id="uiLblBilingualSpan"></span>
          </label>
        </div>

        <button type="submit" class="btn-primary" id="uiBtnPdf">
          Ultra Analizi BaÅŸlat
        </button>
      </form>
    </section>

    <!-- ÅikÃ¢yet ile Analiz Sekmesi -->
    <section class="card main-section" id="tab-complaint" style="display:none;">
      <h1 id="uiComplaintTitle">ÅikÃ¢yet ile Analiz</h1>

      <form class="form" action="/analyze-complaint" method="post" onsubmit="showLoader()">
        <div class="form-group">
          <label id="uiComplaintTextLabel">ÅikÃ¢yet ve mevcut durumunuzu yazÄ±n</label>
          <textarea name="complaint_text" rows="6" required></textarea>
        </div>

        <div class="form-group">
          <label id="uiComplaintBrand">Marka</label>
          <select name="brand">
            <option value="generic">Genel Wellness Analizi (MarkasÄ±z)</option>
            <option value="onemore">OneMore International</option>
            <option value="xaura">Xaura Global</option>
            <option value="atomy">Atomy</option>
            <option value="doctorem">Doctorem International</option>
            <option value="algo_tts">Algophyco TTS</option>
            <option value="herbalife">Herbalife</option>
            <option value="welltures">Welltures Global</option>
            <option value="now">Now International</option>
            <option value="forever">Forever Living</option>
            <option value="siberian">Siberian Wellness</option>
            <option value="amare">Amare Global</option>
            <option value="onyedi">Onyedi Wellness</option>
            <option value="oxo">Oxo Global</option>
            <option value="som">Som International</option>
            <option value="indeva">Ä°ndeva Global</option>
            <option value="pati">PatiPro Wellness</option>
          </select>
        </div>

        <div class="form-group">
          <label id="uiComplaintPrimaryLang">Birinci Dil</label>
          <select name="target_lang" id="targetLangComplaint"></select>
        </div>

        <div class="form-group">
          <label id="uiComplaintSecondLang">Ä°kinci Dil (isteÄŸe baÄŸlÄ±)</label>
          <select name="second_lang" id="secondLangComplaint"></select>
        </div>

        <div class="form-group">
          <label id="uiComplaintBilingual">Ã‡ift Dil (2 kredi)</label>
          <label>
            <input type="checkbox" name="bilingual" value="1">
            <span id="uiComplaintBilingualSpan"></span>
          </label>
        </div>

        <button type="submit" class="btn-primary" id="uiBtnComplaint">
          Analizi BaÅŸlat
        </button>
      </form>
    </section>

    <!-- KarÅŸÄ±laÅŸtÄ±rma Sekmesi -->
    <section class="card main-section" id="tab-compare" style="display:none;">
      <h1 id="uiCompareTitle">Ä°ki Test KarÅŸÄ±laÅŸtÄ±rma</h1>

      <form class="form" action="/compare-tests" method="post" enctype="multipart/form-data" onsubmit="showLoader()">
        <div class="form-group">
          <label id="uiLblOldPdf">Eski Test PDF</label>
          <input type="file" name="old_pdf" accept="application/pdf" required>
        </div>
        <div class="form-group">
          <label id="uiLblNewPdf">Yeni Test PDF</label>
          <input type="file" name="new_pdf" accept="application/pdf" required>
        </div>

        <div class="form-group">
          <label id="uiCompareBrand">Marka</label>
          <select name="brand">
            <option value="generic">Genel Wellness Analizi (MarkasÄ±z)</option>
            <option value="onemore">OneMore International</option>
            <option value="xaura">Xaura Global</option>
            <option value="atomy">Atomy</option>
            <option value="doctorem">Doctorem International</option>
            <option value="algo_tts">Algophyco TTS</option>
            <option value="herbalife">Herbalife</option>
            <option value="welltures">Welltures Global</option>
            <option value="now">Now International</option>
            <option value="forever">Forever Living</option>
            <option value="siberian">Siberian Wellness</option>
            <option value="amare">Amare Global</option>
            <option value="onyedi">Onyedi Wellness</option>
            <option value="oxo">Oxo Global</option>
            <option value="som">Som International</option>
            <option value="indeva">Ä°ndeva Global</option>
            <option value="pati">PatiPro Wellness</option>
          </select>
        </div>

        <div class="form-group">
          <label id="uiComparePrimaryLang">Birinci Dil</label>
          <select name="target_lang" id="targetLangCompare"></select>
        </div>

        <div class="form-group">
          <label id="uiCompareSecondLang">Ä°kinci Dil (isteÄŸe baÄŸlÄ±)</label>
          <select name="second_lang" id="secondLangCompare"></select>
        </div>

        <div class="form-group">
          <label id="uiCompareBilingual">Ã‡ift Dil (2 kredi)</label>
          <label>
            <input type="checkbox" name="bilingual" value="1">
            <span id="uiCompareBilingualSpan"></span>
          </label>
        </div>

        <button type="submit" class="btn-primary" id="uiBtnCompare">
          KarÅŸÄ±laÅŸtÄ±rmayÄ± BaÅŸlat
        </button>
      </form>
    </section>
  </main>
</div>

<!-- Loader Overlay -->
<div id="loader-overlay" class="loader-overlay" style="display:none;">
  <div class="loader"></div>
  <p id="uiLoaderText">Analiz yapÄ±lÄ±yor, lÃ¼tfen bekleyin...</p>
</div>

<script>
// Dil isimleri (rapor dilleri iÃ§in)
const languages = {
  tr:"TÃ¼rkÃ§e",
  en:"English",
  de:"Deutsch",
  es:"EspaÃ±ol",
  pt:"PortuguÃªs",
  fr:"FranÃ§ais",
  ru:"Ğ ÑƒÑÑĞºĞ¸Ğ¹",
  ar:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
  fa:"ÙØ§Ø±Ø³ÛŒ",
  mn:"ĞœĞ¾Ğ½Ğ³Ğ¾Ğ»",
  id:"Bahasa Indonesia",
  it:"Italiano",
  az:"AzÉ™rbaycan dili"
};

// ArayÃ¼z metinleri
const uiTexts = {
  tr: {
    brandName: "WELLNESSANALYZER",
    brandVersion: "UltraPremium v26 Pro",
    globalLangLabel: "ğŸŒ ArayÃ¼z Dili",
    menuPdf: "PDF ile Analiz",
    menuComplaint: "ÅikÃ¢yet ile Analiz",
    menuCompare: "Ä°ki Testi KarÅŸÄ±laÅŸtÄ±r",
    creditsTitle: "Kredi KullanÄ±mÄ±",
    creditsSingle: "âœ… Tek dil analiz: <strong>1 kredi</strong>",
    creditsDouble: "ğŸŒ Ã‡ift dil analiz: <strong>2 kredi</strong>",
    creditsNote: "Ã‡ift dil seÃ§ildiÄŸinde tÃ¼m rapor iÃ§erikleri ve baÅŸlÄ±klar iki dilde (alt alta) hazÄ±rlanÄ±r.",
    historyTitle: "Son Raporlar (60 gÃ¼n)",
    noHistory: "HenÃ¼z kayÄ±tlÄ± rapor yok.",
    pdfTitle: "PDF ile Wellness Analizi",
    pdfSubtitle: "Test PDF'ini yÃ¼kle. Sistem otomatik olarak <strong>Ultra DetaylÄ± Wellness Raporu</strong> Ã¼retir.",
    lblPdfFile: "Test PDF DosyasÄ±",
    lblBrand: "Marka",
    lblPrimaryLang: "Birinci Dil",
    lblSecondLang: "Ä°kinci Dil (isteÄŸe baÄŸlÄ±)",
    noSecondLang: "Tek dil yeterli",
    lblBilingual: "Ã‡ift Dil PDF (2 kredi)",
    btnPdf: "Ultra Analizi BaÅŸlat",
    complaintTitle: "ÅikÃ¢yet ile Analiz",
    complaintTextLabel: "ÅikÃ¢yet ve mevcut durumunuzu yazÄ±n",
    complaintPrimaryLang: "Birinci Dil",
    complaintSecondLang: "Ä°kinci Dil (isteÄŸe baÄŸlÄ±)",
    complaintBilingual: "Ã‡ift Dil (2 kredi)",
    btnComplaint: "Analizi BaÅŸlat",
    compareTitle: "Ä°ki Test KarÅŸÄ±laÅŸtÄ±rma",
    lblOldPdf: "Eski Test PDF",
    lblNewPdf: "Yeni Test PDF",
    comparePrimaryLang: "Birinci Dil",
    compareSecondLang: "Ä°kinci Dil (isteÄŸe baÄŸlÄ±)",
    compareBilingual: "Ã‡ift Dil (2 kredi)",
    btnCompare: "KarÅŸÄ±laÅŸtÄ±rmayÄ± BaÅŸlat",
    loaderText: "Analiz yapÄ±lÄ±yor, lÃ¼tfen bekleyin..."
  },
  // (DiÄŸer diller aynÄ± senin gÃ¶nderdiÄŸin gibi burada devam ediyor; kÄ±saltÄ±yoruz)
};

function fillSelect(el, includeEmpty=false){
  el.innerHTML = "";
  if(includeEmpty){
    el.innerHTML += `<option value="" data-role="nosecond"></option>`;
  }
  Object.entries(languages).forEach(([code,label])=>{
    el.innerHTML += `<option value="${code}">${label}</option>`;
  });
}

// TÃ¼m targetLang / secondLang select'lerini doldur
document.querySelectorAll("select[id^='targetLang']").forEach(s=>fillSelect(s,false));
document.querySelectorAll("select[id^='secondLang']").forEach(s=>fillSelect(s,true));

// Global arayÃ¼z dili
const globalLang = document.getElementById("globalLang");

function applyUiLanguage(lang){
  const t = uiTexts[lang] || uiTexts.tr;

  document.getElementById("uiBrandName").textContent = t.brandName;
  document.getElementById("uiBrandVersion").textContent = t.brandVersion;
  document.getElementById("uiGlobalLangLabel").textContent = t.globalLangLabel;

  document.getElementById("menuPdf").textContent = t.menuPdf;
  document.getElementById("menuComplaint").textContent = t.menuComplaint;
  document.getElementById("menuCompare").textContent = t.menuCompare;

  document.getElementById("uiCreditsTitle").textContent = t.creditsTitle;
  document.getElementById("uiCreditsSingle").innerHTML = t.creditsSingle;
  document.getElementById("uiCreditsDouble").innerHTML = t.creditsDouble;
  document.getElementById("uiCreditsNote").textContent = t.creditsNote;

  document.getElementById("uiHistoryTitle").textContent = t.historyTitle;
  const noHist = document.getElementById("uiNoHistory");
  if(noHist){ noHist.textContent = t.noHistory; }

  document.getElementById("uiPdfTitle").textContent = t.pdfTitle;
  document.getElementById("uiPdfSubtitle").innerHTML = t.pdfSubtitle;
  document.getElementById("uiLblPdfFile").textContent = t.lblPdfFile;
  document.getElementById("uiLblBrandPdf").textContent = t.lblBrand;
  document.getElementById("uiLblPrimaryLang").textContent = t.lblPrimaryLang;
  document.getElementById("uiLblSecondLang").textContent = t.lblSecondLang;
  document.getElementById("uiLblBilingual").textContent = t.lblBilingual;
  document.getElementById("uiBtnPdf").textContent = t.btnPdf;

  document.getElementById("uiComplaintTitle").textContent = t.complaintTitle;
  document.getElementById("uiComplaintTextLabel").textContent = t.complaintTextLabel;
  document.getElementById("uiComplaintBrand").textContent = t.lblBrand;
  document.getElementById("uiComplaintPrimaryLang").textContent = t.complaintPrimaryLang;
  document.getElementById("uiComplaintSecondLang").textContent = t.complaintSecondLang;
  document.getElementById("uiComplaintBilingual").textContent = t.complaintBilingual;
  document.getElementById("uiBtnComplaint").textContent = t.btnComplaint;

  document.getElementById("uiCompareTitle").textContent = t.compareTitle;
  document.getElementById("uiLblOldPdf").textContent = t.lblOldPdf;
  document.getElementById("uiLblNewPdf").textContent = t.lblNewPdf;
  document.getElementById("uiCompareBrand").textContent = t.lblBrand;
  document.getElementById("uiComparePrimaryLang").textContent = t.comparePrimaryLang;
  document.getElementById("uiCompareSecondLang").textContent = t.compareSecondLang;
  document.getElementById("uiCompareBilingual").textContent = t.compareBilingual;
  document.getElementById("uiBtnCompare").textContent = t.btnCompare;

  const loader = document.getElementById("uiLoaderText");
  if(loader){ loader.textContent = t.loaderText; }

  // Ä°kinci dil select'lerindeki "Tek dil yeterli" metnini gÃ¼ncelle
  document.querySelectorAll("select[id^='secondLang']").forEach(sel=>{
    const opt = sel.querySelector('option[data-role="nosecond"]');
    if(opt){ opt.textContent = t.noSecondLang; }
  });
}

// target_lang select'lerini global arayÃ¼z diliyle senkron tut
function syncTargetLangs(oldLang, newLang){
  document.querySelectorAll("select[id^='targetLang']").forEach(sel=>{
    if(!sel.value || sel.value === oldLang){
      sel.value = newLang;
    }
  });
}

const savedLang = localStorage.getItem("globalLang") || "tr";
globalLang.value = savedLang;
globalLang.dataset.current = savedLang;

document.querySelectorAll("select[id^='targetLang']").forEach(sel=>{
  sel.value = savedLang;
});

applyUiLanguage(savedLang);

globalLang.onchange = ()=>{
  const oldLang = globalLang.dataset.current || "tr";
  const lang = globalLang.value || "tr";
  globalLang.dataset.current = lang;
  localStorage.setItem("globalLang", lang);

  applyUiLanguage(lang);
  syncTargetLangs(oldLang, lang);
};

const navItems = document.querySelectorAll('.nav-item[data-target]');
const sections = document.querySelectorAll('.main-section');

navItems.forEach(item => {
  item.addEventListener('click', function (e) {
    e.preventDefault();
    const targetId = this.getAttribute('data-target');

    navItems.forEach(n => n.classList.remove('active'));
    this.classList.add('active');

    sections.forEach(sec => {
      sec.style.display = (sec.id === targetId) ? 'block' : 'none';
    });
  });
});

function showLoader(){
  const el = document.getElementById('loader-overlay');
  if(el){ el.style.display = 'flex'; }
}
</script>

</body>
</html>
